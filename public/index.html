<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Euphoria Browser</title>
<style>
body {
  margin: 0;
  font-family: sans-serif;
  background: #111;
  color: #fff;
  overflow: hidden;
}
#topbar {
  display: flex;
  align-items: center;
  padding: 5px 10px;
  background: #222;
  border-radius: 25px;
  margin: 10px;
}
#topbar button, #topbar input {
  margin: 0 5px;
  height: 35px;
  border-radius: 10px;
  border: none;
}
#topbar input {
  flex: 1;
  padding: 0 10px;
  background: #333;
  color: #fff;
}
#content {
  position: absolute;
  top: 60px;
  bottom: 0;
  left: 0;
  right: 0;
  overflow: auto;
}
#spinner {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: none;
}
</style>
</head>
<body>
<div id="topbar">
  <button id="back">‚óÄ</button>
  <button id="forward">‚ñ∂</button>
  <button id="home">üè†</button>
  <input type="text" id="urlInput" placeholder="Enter URL or search...">
  <button id="go">Go</button>
  <button id="fullscreen">‚õ∂</button>
</div>
<div id="spinner">‚è≥ Loading...</div>
<div id="content"></div>

<script>
const content = document.getElementById("content");
const spinner = document.getElementById("spinner");
const urlInput = document.getElementById("urlInput");

let historyStack = [];
let historyIndex = -1;

async function loadURL(url) {
  spinner.style.display = "block";
  try {
    const res = await fetch("/fetch", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ url })
    });
    const html = await res.text();
    content.innerHTML = html;
  } catch (err) {
    content.innerHTML = `<p style="color:red;">Failed to load page</p>`;
  } finally {
    spinner.style.display = "none";
  }
}

// handle Go button
document.getElementById("go").onclick = () => {
  let val = urlInput.value.trim();
  if (!val) return;
  if (!/^https?:\/\//i.test(val)) {
    // treat as google search
    val = "https://www.google.com/search?q=" + encodeURIComponent(val);
  }
  historyStack = historyStack.slice(0, historyIndex + 1);
  historyStack.push(val);
  historyIndex++;
  loadURL(val);
};

// navigation
document.getElementById("back").onclick = () => {
  if (historyIndex > 0) {
    historyIndex--;
    loadURL(historyStack[historyIndex]);
  }
};
document.getElementById("forward").onclick = () => {
  if (historyIndex < historyStack.length - 1) {
    historyIndex++;
    loadURL(historyStack[historyIndex]);
  }
};
document.getElementById("home").onclick = () => {
  urlInput.value = "google.com";
  document.getElementById("go").click();
};
document.getElementById("fullscreen").onclick = () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
};

// enter key
urlInput.addEventListener("keypress", e => {
  if (e.key === "Enter") document.getElementById("go").click();
});

// initial load
document.getElementById("home").click();
</script>
</body>
</html>
