<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Euphoria Mini Browser</title>
<style>
body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; background: #1e1e2f; color: #f0f0f0; }
header { padding: 0.5rem; background: #2e2e3e; display: flex; align-items: center; gap: 0.5rem; }
input { flex: 1; padding: 0.5rem; border-radius: 5px; border: none; }
button { padding: 0.5rem 1rem; border: none; border-radius: 5px; background: #4cafef; color: white; cursor: pointer; }
button:hover { background: #3690d9; }
#browser { flex: 1; overflow: auto; background: white; color: black; padding: 1rem; }
</style>
</head>
<body>

<header>
  <button onclick="goBack()">‚óÄ</button>
  <button onclick="goForward()">‚ñ∂</button>
  <button onclick="refreshPage()">‚ü≥</button>
  <button onclick="goHome()">üè†</button>
  <input id="url" type="text" placeholder="Enter URL or search term" onkeypress="handleEnter(event)">
  <button onclick="navigate()">Go</button>
</header>

<div id="browser">Page content will appear here...</div>

<script>
const browser = document.getElementById("browser");
let historyStack = [];
let historyIndex = -1;

function normalizeURL(input) {
  input = input.trim();
  if (!input) return "https://www.google.com";
  if (!input.includes(".") && !input.startsWith("http")) {
    return `https://www.google.com/search?q=${encodeURIComponent(input)}`;
  }
  if (!/^https?:\/\//i.test(input)) input = "https://" + input;
  return input;
}

async function navigate() {
  let url = document.getElementById("url").value;
  url = normalizeURL(url);

  if (historyIndex === -1 || historyStack[historyIndex] !== url) {
    historyStack = historyStack.slice(0, historyIndex + 1);
    historyStack.push(url);
    historyIndex++;
  }

  document.getElementById("url").value = url;
  browser.textContent = "Loading‚Ä¶";

  try {
    const res = await fetch(`/proxy?url=${encodeURIComponent(url)}`);
    const html = await res.text();
    browser.innerHTML = html;
  } catch (err) {
    browser.textContent = "Error: " + err.message;
  }
}

function goBack() { if (historyIndex > 0) { historyIndex--; document.getElementById("url").value = historyStack[historyIndex]; navigate(); } }
function goForward() { if (historyIndex < historyStack.length - 1) { historyIndex++; document.getElementById("url").value = historyStack[historyIndex]; navigate(); } }
function refreshPage() { if (historyIndex >= 0) navigate(); }
function goHome() { const home="https://www.google.com"; historyStack = historyStack.slice(0, historyIndex+1); historyStack.push(home); historyIndex++; document.getElementById("url").value=home; navigate(); }
function handleEnter(e) { if(e.key==="Enter") navigate(); }
</script>

</body>
</html>