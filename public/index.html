<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Euphoria Browser</title>
<style>
  body { margin:0; font-family:sans-serif; overflow:hidden; background:#f0f0f0; }
  #topbar { display:flex; align-items:center; padding:0.5rem; background:#222; color:#fff; gap:0.5rem; border-radius:0 0 12px 12px; }
  button { padding:0.5rem 1rem; border:none; border-radius:8px; cursor:pointer; background:#444; color:#fff; flex:1; }
  button:hover { background:#666; }
  #urlbar { flex:3; padding:0.5rem; border-radius:8px; border:none; outline:none; }
  #spinner { position:absolute; top:0; left:0; right:0; bottom:0; display:flex; justify-content:center; align-items:center; background:rgba(0,0,0,0.3); z-index:10; visibility:hidden; }
  .spinner { width:50px; height:50px; border:5px solid #f3f3f3; border-top:5px solid #444; border-radius:50%; animation:spin 1s linear infinite; }
  @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
  #content { width:100%; height:calc(100vh - 60px); border:none; }
</style>
</head>
<body>
<div id="topbar">
  <button id="home">Home</button>
  <button id="back">←</button>
  <button id="forward">→</button>
  <input type="text" id="urlbar" placeholder="Enter URL or search...">
  <button id="go">Go</button>
  <button id="fullscreen">⛶</button>
</div>
<div id="spinner"><div class="spinner"></div></div>
<iframe id="content"></iframe>

<script>
const iframe = document.getElementById("content");
const spinner = document.getElementById("spinner");
const urlbar = document.getElementById("urlbar");

const historyStack = [];
let currentIndex = -1;

function showSpinner(show) { spinner.style.visibility = show ? "visible" : "hidden"; }

function loadURL(url) {
  if (!url.startsWith("http")) url = "https://" + url;
  showSpinner(true);
  iframe.src = "/proxy?url=" + encodeURIComponent(url);
  urlbar.value = url;

  if(currentIndex === -1 || historyStack[currentIndex] !== url){
    historyStack.splice(currentIndex+1);
    historyStack.push(url);
    currentIndex = historyStack.length -1;
  }
}

document.getElementById("go").onclick = () => loadURL(urlbar.value);
document.getElementById("home").onclick = () => loadURL("https://www.google.com");
document.getElementById("back").onclick = () => { if(currentIndex>0) loadURL(historyStack[--currentIndex]); };
document.getElementById("forward").onclick = () => { if(currentIndex<historyStack.length-1) loadURL(historyStack[++currentIndex]); };
document.getElementById("fullscreen").onclick = () => {
  if (!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
};

iframe.onload = () => showSpinner(false);

// Load Google by default
loadURL("https://www.google.com");
</script>
</body>
</html>
