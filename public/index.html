<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Euphoria Mini Browser</title>
<style>
body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #1e1e2f; color: #f0f0f0; height: 100vh; display: flex; flex-direction: column; }
header { padding: 0.5rem; background: #2e2e3e; display: flex; align-items: center; gap: 0.5rem; }
input { flex: 1; padding: 0.5rem; border-radius: 5px; border: none; }
button { padding: 0.5rem 1rem; border: none; border-radius: 5px; background: #4cafef; color: white; cursor: pointer; }
button:hover { background: #3690d9; }
iframe { flex: 1; border: none; width: 100%; }
</style>
</head>
<body>

<header>
  <button onclick="goBack()">‚óÄ</button>
  <button onclick="goForward()">‚ñ∂</button>
  <button onclick="refreshPage()">‚ü≥</button>
  <button onclick="goHome()">üè†</button>
  <input id="url" type="text" placeholder="Enter URL or search term" onkeypress="handleEnter(event)">
  <button onclick="navigate()">Go</button>
</header>

<iframe id="browser" src=""></iframe>

<script>
const iframe = document.getElementById("browser");
let historyStack = [];
let historyIndex = -1;

function normalizeURL(input) {
  input = input.trim();
  // If input is empty, go home
  if (!input) return "https://www.google.com";
  
  // If it doesn't look like a URL, make it a Google search
  if (!input.includes(".") && !input.startsWith("http")) {
    return `https://www.google.com/search?q=${encodeURIComponent(input)}`;
  }

  // Add https:// if missing
  if (!/^https?:\/\//i.test(input)) {
    input = "https://" + input;
  }
  return input;
}

function navigate() {
  let url = document.getElementById("url").value;
  url = normalizeURL(url);

  // Update history
  if (historyIndex === -1 || historyStack[historyIndex] !== url) {
    historyStack = historyStack.slice(0, historyIndex + 1);
    historyStack.push(url);
    historyIndex++;
  }

  iframe.src = `/proxy?url=${encodeURIComponent(url)}`;
  document.getElementById("url").value = url;
}

function goBack() {
  if (historyIndex > 0) {
    historyIndex--;
    const url = historyStack[historyIndex];
    iframe.src = `/proxy?url=${encodeURIComponent(url)}`;
    document.getElementById("url").value = url;
  }
}

function goForward() {
  if (historyIndex < historyStack.length - 1) {
    historyIndex++;
    const url = historyStack[historyIndex];
    iframe.src = `/proxy?url=${encodeURIComponent(url)}`;
    document.getElementById("url").value = url;
  }
}

function refreshPage() {
  if (historyIndex >= 0) {
    const url = historyStack[historyIndex];
    iframe.src = `/proxy?url=${encodeURIComponent(url)}`;
  }
}

function goHome() {
  const home = "https://www.google.com";
  historyStack = historyStack.slice(0, historyIndex + 1);
  historyStack.push(home);
  historyIndex++;
  iframe.src = `/proxy?url=${encodeURIComponent(home)}`;
  document.getElementById("url").value = home;
}

function handleEnter(e) {
  if (e.key === "Enter") {
    navigate();
  }
}
</script>

</body>
</html>