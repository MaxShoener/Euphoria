<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Euphoria — Hybrid</title>
<style>
:root{
  --bg:#0b0c0e;
  --fg:#ffffff;
  --muted:#b5bcc2;
  --panel:rgba(18,18,18,0.55);
  --control:rgba(255,255,255,0.08);
  --control2:rgba(255,255,255,0.12);
  --accent:#4caf50;
  --danger:#ef5350;
}
[data-theme="light"]{
  --bg:#f4f6f8;
  --fg:#101316;
  --muted:#4b5560;
  --panel:rgba(255,255,255,0.75);
  --control:rgba(16,19,22,0.08);
  --control2:rgba(16,19,22,0.12);
  --accent:#2e7d32;
}
html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial}
#topbar{
  position:fixed;top:14px;left:50%;transform:translateX(-50%);
  width:min(1120px,92%);height:58px;
  background:var(--panel);
  border-radius:999px;
  backdrop-filter:blur(14px);
  -webkit-backdrop-filter:blur(14px);
  display:flex;align-items:center;gap:10px;
  padding:0 14px;
  z-index:50;
  box-shadow:0 10px 34px rgba(0,0,0,.25);
}
.btn{
  border:0;
  background:var(--control);
  color:var(--fg);
  height:38px;
  padding:0 14px;
  border-radius:999px;
  cursor:pointer;
  font-size:14px;
}
.btn:hover{background:var(--control2)}
.btn:active{transform:translateY(1px)}
#url{
  flex:1;
  height:38px;
  border-radius:999px;
  border:0;
  outline:none;
  background:transparent;
  color:var(--fg);
  font-size:15px;
  padding:0 8px;
}
.pill{
  display:inline-flex;align-items:center;gap:8px;
  background:var(--control);
  border-radius:999px;
  height:38px;padding:0 12px;
  font-size:13px;color:var(--muted);
}
.dot{width:9px;height:9px;border-radius:50%;background:var(--accent)}
.dot.off{background:var(--danger)}
#wrap{position:absolute;inset:0}
#home{
  position:absolute;inset:0;
  display:flex;align-items:center;justify-content:center;
  padding-top:74px;
}
.card{
  width:min(720px,92%);
  background:var(--panel);
  border-radius:24px;
  padding:26px 22px;
  box-shadow:0 14px 44px rgba(0,0,0,.28);
}
h1{margin:0 0 6px 0;font-size:28px}
p{margin:0 0 18px 0;color:var(--muted);line-height:1.45}
#homeInput{
  width:100%;
  height:48px;
  border-radius:999px;
  border:0;
  outline:none;
  background:var(--control);
  color:var(--fg);
  font-size:16px;
  padding:0 18px;
}
.row{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
.small{font-size:12px;color:var(--muted)}
kbd{
  font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
  background:var(--control);
  border-radius:6px;
  padding:2px 6px;
  font-size:12px;color:var(--fg)
}
#frame{
  position:absolute;inset:0;
  border:0;
  width:100%;height:100%;
}
#settings{
  position:fixed;top:80px;left:50%;transform:translateX(-50%);
  width:min(520px,92%);
  background:var(--panel);
  border-radius:20px;
  padding:16px;
  display:none;
  z-index:60;
  box-shadow:0 14px 44px rgba(0,0,0,.28);
}
.setRow{display:flex;align-items:center;justify-content:space-between;gap:10px;margin:10px 0}
.toggle{
  display:inline-flex;align-items:center;gap:10px;
  background:var(--control);
  padding:8px 12px;border-radius:999px;
}
select{
  background:var(--control);
  color:var(--fg);
  border:0;
  border-radius:999px;
  padding:8px 12px;
}
</style>
</head>
<body>

<div id="wrap">
  <div id="topbar">
    <button class="btn" id="backBtn" title="Back">←</button>
    <button class="btn" id="fwdBtn" title="Forward">→</button>
    <button class="btn" id="reloadBtn" title="Reload">⟳</button>
    <button class="btn" id="homeBtn" title="Home">Home</button>

    <input id="url" placeholder="Search or enter address"/>

    <button class="btn" id="goBtn">Go</button>
    <div class="pill" id="modePill" title="Mode">
      <span class="dot" id="modeDot"></span>
      <span id="modeLabel">Rewrite</span>
    </div>
    <button class="btn" id="settingsBtn" title="Settings">⚙</button>
  </div>

  <div id="settings">
    <div class="setRow">
      <div>
        <div style="font-weight:600">Default mode</div>
        <div class="small">Rewrite is faster; Scramjet is better for complex sites.</div>
      </div>
      <select id="defaultMode">
        <option value="rewrite">Rewrite</option>
        <option value="scramjet">Scramjet</option>
      </select>
    </div>
    <div class="setRow">
      <div>
        <div style="font-weight:600">Theme</div>
        <div class="small">Light/dark UI.</div>
      </div>
      <select id="theme">
        <option value="dark">Dark</option>
        <option value="light">Light</option>
      </select>
    </div>
    <div class="setRow">
      <div class="small">Tip: Press <kbd>/</kbd> to focus the bar, <kbd>Enter</kbd> to go.</div>
      <button class="btn" id="closeSettings">Close</button>
    </div>
  </div>

  <div id="home">
    <div class="card">
      <h1>Euphoria</h1>
      <p>Search or open a site. If a site’s UI doesn’t load properly, switch to <b>Scramjet</b>.</p>
      <input id="homeInput" placeholder="Search Google or enter a URL"/>
      <div class="row">
        <button class="btn" id="quickGoogle">Google</button>
        <button class="btn" id="quickXbox">Xbox</button>
        <button class="btn" id="quickDiscord">Discord</button>
        <button class="btn" id="quickYT">YouTube</button>
      </div>
      <div style="margin-top:12px" class="small">
        Modes: <b>Rewrite</b> (fast) vs <b>Scramjet</b> (compat).
      </div>
    </div>
  </div>

  <iframe id="frame" referrerpolicy="no-referrer"></iframe>
</div>

<script>
(() => {
  const frame = document.getElementById("frame");
  const home = document.getElementById("home");
  const urlBar = document.getElementById("url");
  const homeInput = document.getElementById("homeInput");

  const modeDot = document.getElementById("modeDot");
  const modeLabel = document.getElementById("modeLabel");
  const modePill = document.getElementById("modePill");

  const settings = document.getElementById("settings");
  const settingsBtn = document.getElementById("settingsBtn");
  const closeSettings = document.getElementById("closeSettings");
  const defaultMode = document.getElementById("defaultMode");
  const theme = document.getElementById("theme");

  const backBtn = document.getElementById("backBtn");
  const fwdBtn = document.getElementById("fwdBtn");
  const reloadBtn = document.getElementById("reloadBtn");
  const homeBtn = document.getElementById("homeBtn");
  const goBtn = document.getElementById("goBtn");

  let mode = localStorage.getItem("euph_mode") || "rewrite";
  let th = localStorage.getItem("euph_theme") || "dark";

  function applyTheme() {
    document.documentElement.setAttribute("data-theme", th);
    theme.value = th;
  }
  function applyModeUI() {
    const sj = mode === "scramjet";
    modeDot.className = "dot" + (sj ? "" : "");
    modeDot.style.background = sj ? "var(--accent)" : "var(--accent)";
    modeLabel.textContent = sj ? "Scramjet" : "Rewrite";
    defaultMode.value = mode;
  }

  function normalize(v) {
    v = (v || "").trim();
    if (!v) return null;
    if (/^https?:\/\//i.test(v)) return v;
    if (!v.includes(".") || v.includes(" ")) {
      return "https://www.google.com/search?q=" + encodeURIComponent(v);
    }
    return "https://" + v;
  }

  function buildProxyUrl(target) {
    const u = normalize(target);
    if (!u) return null;
    if (mode === "scramjet") return "/sj?url=" + encodeURIComponent(u);
    return "/proxy?url=" + encodeURIComponent(u);
  }

  function navigate(target) {
    const p = buildProxyUrl(target);
    if (!p) return;
    frame.src = p;
    home.style.display = "none";
    urlBar.value = normalize(target) || target;
  }

  function showHome() {
    frame.src = "about:blank";
    home.style.display = "flex";
  }

  // Controls
  backBtn.onclick = () => { try { frame.contentWindow.history.back(); } catch {} };
  fwdBtn.onclick = () => { try { frame.contentWindow.history.forward(); } catch {} };
  reloadBtn.onclick = () => { try { frame.contentWindow.location.reload(); } catch { frame.src = frame.src; } };
  homeBtn.onclick = showHome;
  goBtn.onclick = () => navigate(urlBar.value);

  urlBar.addEventListener("keydown", (e) => { if (e.key === "Enter") navigate(urlBar.value); });
  homeInput.addEventListener("keydown", (e) => { if (e.key === "Enter") navigate(homeInput.value); });

  // Mode toggle
  modePill.onclick = () => {
    mode = (mode === "rewrite") ? "scramjet" : "rewrite";
    localStorage.setItem("euph_mode", mode);
    applyModeUI();
    if (frame.src && frame.src !== "about:blank") {
      const current = urlBar.value || "";
      if (current) navigate(current);
    }
  };

  // Settings
  settingsBtn.onclick = () => settings.style.display = (settings.style.display === "block" ? "none" : "block");
  closeSettings.onclick = () => settings.style.display = "none";

  defaultMode.onchange = () => {
    mode = defaultMode.value;
    localStorage.setItem("euph_mode", mode);
    applyModeUI();
  };

  theme.onchange = () => {
    th = theme.value;
    localStorage.setItem("euph_theme", th);
    applyTheme();
  };

  // Quick links
  document.getElementById("quickGoogle").onclick = () => navigate("google.com");
  document.getElementById("quickXbox").onclick = () => { mode = "scramjet"; localStorage.setItem("euph_mode", mode); applyModeUI(); navigate("xbox.com"); };
  document.getElementById("quickDiscord").onclick = () => { mode = "scramjet"; localStorage.setItem("euph_mode", mode); applyModeUI(); navigate("discord.com"); };
  document.getElementById("quickYT").onclick = () => navigate("youtube.com");

  // Keyboard shortcut
  window.addEventListener("keydown", (e) => {
    if (e.key === "/" && document.activeElement !== urlBar && document.activeElement !== homeInput) {
      e.preventDefault();
      urlBar.focus();
    }
    if (e.key === "Escape") settings.style.display = "none";
  });

  // Init
  applyTheme();
  applyModeUI();
})();
</script>

</body>
</html>