<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Euphoria Browser</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: sans-serif; }
    body, html { height: 100%; overflow: hidden; background: #1a1a1a; color: #fff; }
    
    #navbar {
      display: flex;
      align-items: center;
      padding: 5px;
      background: #222;
      gap: 5px;
    }

    #navbar button {
      flex: none;
      padding: 8px 12px;
      background: #333;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 14px;
      min-width: 60px;
      text-align: center;
    }

    #navbar button:hover { background: #555; }

    #search-bar {
      flex: 1;
      padding: 8px;
      background: #333;
      border: none;
      color: #fff;
    }

    #content {
      position: relative;
      width: 100%;
      height: calc(100% - 45px);
      overflow: auto;
      background: #000;
    }

    #spinner {
      position: absolute;
      top: 45px;
      left: 0;
      width: 100%;
      height: calc(100% - 45px);
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      pointer-events: none;
      display: none;
    }

    .spinner-icon {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #555;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>

  <div id="navbar">
    <button id="back">‚óÄ Back</button>
    <button id="forward">‚ñ∂ Forward</button>
    <button id="home">üè† Home</button>
    <button id="refresh">‚ü≥ Refresh</button>
    <input id="search-bar" type="text" placeholder="Enter URL or search..." />
    <button id="fullscreen">‚õ∂ Fullscreen</button>
  </div>

  <div id="content">
    <div id="spinner"><div class="spinner-icon"></div></div>
    <iframe id="view" src=""></iframe>
  </div>

  <script>
    const searchBar = document.getElementById("search-bar");
    const iframe = document.getElementById("view");
    const spinner = document.getElementById("spinner");

    const backBtn = document.getElementById("back");
    const forwardBtn = document.getElementById("forward");
    const refreshBtn = document.getElementById("refresh");
    const homeBtn = document.getElementById("home");
    const fullscreenBtn = document.getElementById("fullscreen");

    const historyStack = [];
    let historyIndex = -1;

    function showSpinner() { spinner.style.display = "flex"; }
    function hideSpinner() { spinner.style.display = "none"; }

    function loadUrl(url) {
      if (!url.startsWith("http")) url = "https://" + url;
      showSpinner();
      iframe.src = "/proxy?url=" + encodeURIComponent(url);
    }

    function autoLoadInput(input) {
      input = input.trim();
      if (!input) return;
      if (input.includes(" ") || !input.includes(".")) {
        // Treat as Google search
        loadUrl("https://www.google.com/search?q=" + encodeURIComponent(input));
      } else {
        // Treat as URL
        loadUrl(input);
      }
      // Update history
      historyStack.splice(historyIndex + 1);
      historyStack.push(input);
      historyIndex++;
    }

    searchBar.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        autoLoadInput(searchBar.value);
      }
    });

    iframe.addEventListener("load", () => hideSpinner());

    backBtn.onclick = () => {
      if (historyIndex > 0) {
        historyIndex--;
        searchBar.value = historyStack[historyIndex];
        autoLoadInput(historyStack[historyIndex]);
      }
    };

    forwardBtn.onclick = () => {
      if (historyIndex < historyStack.length - 1) {
        historyIndex++;
        searchBar.value = historyStack[historyIndex];
        autoLoadInput(historyStack[historyIndex]);
      }
    };

    refreshBtn.onclick = () => {
      if (historyIndex >= 0) autoLoadInput(historyStack[historyIndex]);
    };

    homeBtn.onclick = () => {
      searchBar.value = "google.com";
      autoLoadInput("google.com");
    };

    fullscreenBtn.onclick = () => {
      if (!document.fullscreenElement) document.documentElement.requestFullscreen();
      else document.exitFullscreen();
    };

    // Load home by default
    autoLoadInput("google.com");
  </script>
</body>
</html>
